{"version":3,"sources":["webpack:///dist/live-coder.min.js","webpack:///webpack/bootstrap 110147454824b4c31171","webpack:///./src/index.ts","webpack:///./src/utils.ts","webpack:///./src/deferred.ts"],"names":["Live","modules","__webpack_require__","moduleId","installedModules","exports","module","id","loaded","call","m","c","p","utils_1","Coder","config","this","Object","assign","DEFAULT_CONFIG","$runner","document","getElementsByTagName","body","$wrapperElem","createElement","wrapperElement","$body","$display","createDisplay","prototype","tagName","props","$appendTo","$elem","_i","_a","keys","length","propName","appendChild","className","displayClass","createStyle","type","createScript","updateDisplayScroll","run","code","_this","$style","$element","elemInnerHtml","$script","lines","trim","split","asyncForOf","line","forOfPromise","returnPromise","Promise","resolve","chars","match","DIR_RE","char","textContent","typingSpeed","then","section","rest","slice","toLowerCase","elem","apply","_b","selector","SEL_RE","querySelector","_c","symbol","name_1","parentElement","innerHTML","window","domReady","callback","addEventListener","asyncLoop","fn","condition","delay","deferred","deferred_1","Deferred","loop","setTimeout","catch","reject","promise","array","index","conditionLoop","bodyLoop","value"],"mappings":"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","file":"dist/live-coder.min.js","sourcesContent":["var Live =\n/******/ (function(modules) { // webpackBootstrap\n/******/ \t// The module cache\n/******/ \tvar installedModules = {};\n/******/\n/******/ \t// The require function\n/******/ \tfunction __webpack_require__(moduleId) {\n/******/\n/******/ \t\t// Check if module is in cache\n/******/ \t\tif(installedModules[moduleId])\n/******/ \t\t\treturn installedModules[moduleId].exports;\n/******/\n/******/ \t\t// Create a new module (and put it into the cache)\n/******/ \t\tvar module = installedModules[moduleId] = {\n/******/ \t\t\texports: {},\n/******/ \t\t\tid: moduleId,\n/******/ \t\t\tloaded: false\n/******/ \t\t};\n/******/\n/******/ \t\t// Execute the module function\n/******/ \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n/******/\n/******/ \t\t// Flag the module as loaded\n/******/ \t\tmodule.loaded = true;\n/******/\n/******/ \t\t// Return the exports of the module\n/******/ \t\treturn module.exports;\n/******/ \t}\n/******/\n/******/\n/******/ \t// expose the modules object (__webpack_modules__)\n/******/ \t__webpack_require__.m = modules;\n/******/\n/******/ \t// expose the module cache\n/******/ \t__webpack_require__.c = installedModules;\n/******/\n/******/ \t// __webpack_public_path__\n/******/ \t__webpack_require__.p = \"\";\n/******/\n/******/ \t// Load entry module and return exports\n/******/ \treturn __webpack_require__(0);\n/******/ })\n/************************************************************************/\n/******/ ([\n/* 0 */\n/***/ function(module, exports, __webpack_require__) {\n\n\t\"use strict\";\n\tvar utils_1 = __webpack_require__(1);\n\tvar Coder = (function () {\n\t    function Coder(config) {\n\t        if (config === void 0) { config = {}; }\n\t        this.config = Object.assign({}, Coder.DEFAULT_CONFIG, config);\n\t        this.$runner = document.getElementsByTagName('head')[0] || document.body;\n\t        this.$wrapperElem = this.createElement(this.config.wrapperElement);\n\t        this.$body = document.body;\n\t        this.$display = this.createDisplay();\n\t    }\n\t    Coder.prototype.createElement = function (tagName, props, $appendTo) {\n\t        if (props === void 0) { props = {}; }\n\t        var $elem = document.createElement(tagName);\n\t        for (var _i = 0, _a = Object.keys(props); _i < _a.length; _i++) {\n\t            var propName = _a[_i];\n\t            $elem[propName] = props[propName];\n\t        }\n\t        if ($appendTo) {\n\t            $appendTo.appendChild($elem);\n\t        }\n\t        return $elem;\n\t    };\n\t    Coder.prototype.createDisplay = function () {\n\t        return this.createElement('pre', { className: this.config.displayClass }, document.body);\n\t    };\n\t    Coder.prototype.createStyle = function (type) {\n\t        if (type === void 0) { type = 'text/css'; }\n\t        return this.createElement('style', { type: type });\n\t    };\n\t    Coder.prototype.createScript = function (type) {\n\t        if (type === void 0) { type = 'text/javascript'; }\n\t        return this.createElement('script', { type: type });\n\t    };\n\t    Coder.prototype.updateDisplayScroll = function () { };\n\t    Coder.prototype.run = function (code) {\n\t        var _this = this;\n\t        if (code === void 0) { code = ''; }\n\t        var lines = code.trim().split('\\n');\n\t        var $style;\n\t        var $element;\n\t        var elemInnerHtml;\n\t        var $script;\n\t        return utils_1.asyncForOf(function (line) {\n\t            var forOfPromise;\n\t            var returnPromise = Promise.resolve();\n\t            var chars = line.split('');\n\t            var match = line.match(Coder.DIR_RE);\n\t            if (match) {\n\t                forOfPromise = utils_1.asyncForOf(function (char) {\n\t                    _this.$display.textContent += char;\n\t                    return returnPromise;\n\t                }, chars, _this.config.typingSpeed).then(function () {\n\t                    _this.$display.textContent += '\\n';\n\t                    var _a = match[1].split(':'), section = _a[0], rest = _a.slice(1);\n\t                    switch (section.toLowerCase()) {\n\t                        case 'css':\n\t                            // --- css\n\t                            // --- css:apply\n\t                            $script = null;\n\t                            $element = null;\n\t                            elemInnerHtml = '';\n\t                            $style = _this.createStyle();\n\t                            if (rest[0] && rest[0].toLowerCase() === 'apply') {\n\t                                _this.$runner.appendChild($style);\n\t                            }\n\t                            break;\n\t                        case 'js':\n\t                            $style = null;\n\t                            $element = null;\n\t                            elemInnerHtml = '';\n\t                            $script = _this.createScript();\n\t                            // can't be apply at this point, only at the end,\n\t                            // would throw exeptions\n\t                            break;\n\t                        case 'html':\n\t                            // --- html ($wrapperElem)\n\t                            // --- html:apply ($wrapperElem)\n\t                            // --- html:tag\n\t                            // --- html:tag.class\n\t                            // --- html:.class (tag = div)\n\t                            // --- html:tag#id\n\t                            // --- html:#id (tag = div)\n\t                            // --- html:tag:apply\n\t                            // --- html:apply:tag\n\t                            $script = null;\n\t                            $style = null;\n\t                            elemInnerHtml = '';\n\t                            if (rest[0]) {\n\t                                var elem = rest[0], apply = rest[1];\n\t                                // let's swap if the first one is \"apply\"\n\t                                if (elem.toLowerCase() === 'apply') {\n\t                                    _b = [apply || '', elem], elem = _b[0], apply = _b[1];\n\t                                }\n\t                                var selector = elem.match(Coder.SEL_RE);\n\t                                // valid selector?\n\t                                if (elem && selector) {\n\t                                    $element = document.querySelector(elem);\n\t                                    // does the element exist in the DOM?\n\t                                    if (!$element) {\n\t                                        var _c = [selector[1] || 'div', selector[3], selector[4]], tagName = _c[0], symbol = _c[1], name_1 = _c[2];\n\t                                        $element = _this.createElement(tagName);\n\t                                        if (symbol && name_1) {\n\t                                            // I know, this is crappy. Only supports classes or ids\n\t                                            // and not even combined. TODO: make it better\n\t                                            switch (symbol) {\n\t                                                case '.':\n\t                                                    $element.className = name_1;\n\t                                                    break;\n\t                                                case '#':\n\t                                                    $element.id = name_1;\n\t                                                    break;\n\t                                            }\n\t                                        }\n\t                                        if (apply &&\n\t                                            apply.toLowerCase() === 'apply' &&\n\t                                            !$element.parentElement) {\n\t                                            _this.$body.appendChild($element);\n\t                                        }\n\t                                    }\n\t                                }\n\t                                else {\n\t                                    $element = _this.$wrapperElem;\n\t                                    if (apply &&\n\t                                        apply.toLowerCase() === 'apply' &&\n\t                                        !$element.parentElement) {\n\t                                        _this.$body.appendChild($element);\n\t                                    }\n\t                                }\n\t                            }\n\t                            $element = $element || _this.$wrapperElem;\n\t                            // in case there was already content\n\t                            // we can continue writing html in the element\n\t                            elemInnerHtml = $element.innerHTML;\n\t                            break;\n\t                        case 'apply':\n\t                            if ($style && !$style.parentElement) {\n\t                                _this.$runner.appendChild($style);\n\t                                $style = _this.createStyle();\n\t                            }\n\t                            else if ($element && !$element.parentElement) {\n\t                                _this.$body.appendChild($element);\n\t                            }\n\t                            else if ($script && !$script.parentElement) {\n\t                                _this.$runner.appendChild($script);\n\t                                $script = _this.createScript();\n\t                            }\n\t                            break;\n\t                        case 'promise':\n\t                            if (window[rest[0]] instanceof Promise) {\n\t                                returnPromise = window[rest[0]];\n\t                            }\n\t                            break;\n\t                    }\n\t                    return returnPromise;\n\t                    var _b;\n\t                });\n\t            }\n\t            else {\n\t                forOfPromise = utils_1.asyncForOf(function (char) {\n\t                    _this.$display.textContent += char;\n\t                    if ($style) {\n\t                        $style.textContent += char;\n\t                    }\n\t                    else if ($element) {\n\t                        // in order to be able to write dynamic html and\n\t                        // see the changes right away, we need to store\n\t                        // the html as a string and innerHTML this string\n\t                        // into the the element right away. If we don't do so, \n\t                        // we lose markup because it becomes invalid and gets lost\n\t                        elemInnerHtml += char;\n\t                        $element.innerHTML = elemInnerHtml;\n\t                    }\n\t                    else if ($script) {\n\t                        $script.textContent += char;\n\t                    }\n\t                    return returnPromise;\n\t                }, chars, _this.config.typingSpeed).then(function () {\n\t                    _this.$display.textContent += '\\n';\n\t                    if ($style) {\n\t                        $style.textContent += '\\n';\n\t                    }\n\t                    else if ($script) {\n\t                        $script.textContent += '\\n';\n\t                    }\n\t                    return returnPromise;\n\t                });\n\t            }\n\t            return forOfPromise;\n\t        }, lines).then(function () {\n\t            $style = null;\n\t            $element = null;\n\t            elemInnerHtml = '';\n\t            $script = null;\n\t            return Promise.resolve();\n\t        });\n\t    };\n\t    Coder.DIR_RE = /^\\s*---\\s*([a-z0-9|\\-|_|\\.|#|:]+)?/i;\n\t    Coder.SEL_RE = /^([a-z0-9|\\-|_]+)?((\\.|#)([a-z0-9|\\-|_]+))?$/i;\n\t    Coder.domReady = function (callback) {\n\t        document.addEventListener('DOMContentLoaded', callback);\n\t    };\n\t    Coder.DEFAULT_CONFIG = {\n\t        displayClass: 'live-coder__display',\n\t        wrapperElement: 'wrapper-element',\n\t        typingSpeed: 50\n\t    };\n\t    return Coder;\n\t}());\n\texports.Coder = Coder;\n\n\n/***/ },\n/* 1 */\n/***/ function(module, exports, __webpack_require__) {\n\n\t\"use strict\";\n\tvar deferred_1 = __webpack_require__(2);\n\tfunction asyncLoop(fn, condition, delay) {\n\t    var deferred = new deferred_1.Deferred();\n\t    var loop = function () {\n\t        if (condition()) {\n\t            fn()\n\t                .then(function () {\n\t                if (delay) {\n\t                    setTimeout(loop, delay);\n\t                }\n\t                else {\n\t                    loop();\n\t                }\n\t            })\n\t                .catch(function () { return deferred.reject(); });\n\t        }\n\t        else {\n\t            deferred.resolve();\n\t        }\n\t    };\n\t    loop();\n\t    return deferred.promise;\n\t}\n\texports.asyncLoop = asyncLoop;\n\tfunction asyncForOf(fn, array, delay) {\n\t    var index = 0;\n\t    var length = array.length;\n\t    var value;\n\t    var conditionLoop = function () { return index < length; };\n\t    var bodyLoop = function () {\n\t        var value = array[index];\n\t        var promise = fn(value);\n\t        index++;\n\t        return promise;\n\t    };\n\t    return asyncLoop(bodyLoop, conditionLoop, delay);\n\t}\n\texports.asyncForOf = asyncForOf;\n\n\n/***/ },\n/* 2 */\n/***/ function(module, exports) {\n\n\t\"use strict\";\n\tvar Deferred = (function () {\n\t    function Deferred() {\n\t        var _this = this;\n\t        this.promise = new Promise(function (resolve, reject) {\n\t            _this.resolve = resolve;\n\t            _this.reject = reject;\n\t        });\n\t    }\n\t    return Deferred;\n\t}());\n\texports.Deferred = Deferred;\n\n\n/***/ }\n/******/ ]);\n\n\n// WEBPACK FOOTER //\n// dist/live-coder.min.js"," \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId])\n \t\t\treturn installedModules[moduleId].exports;\n\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\texports: {},\n \t\t\tid: moduleId,\n \t\t\tloaded: false\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.loaded = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"\";\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(0);\n\n\n\n// WEBPACK FOOTER //\n// webpack/bootstrap 110147454824b4c31171","\"use strict\";\nvar utils_1 = require('./utils');\nvar Coder = (function () {\n    function Coder(config) {\n        if (config === void 0) { config = {}; }\n        this.config = Object.assign({}, Coder.DEFAULT_CONFIG, config);\n        this.$runner = document.getElementsByTagName('head')[0] || document.body;\n        this.$wrapperElem = this.createElement(this.config.wrapperElement);\n        this.$body = document.body;\n        this.$display = this.createDisplay();\n    }\n    Coder.prototype.createElement = function (tagName, props, $appendTo) {\n        if (props === void 0) { props = {}; }\n        var $elem = document.createElement(tagName);\n        for (var _i = 0, _a = Object.keys(props); _i < _a.length; _i++) {\n            var propName = _a[_i];\n            $elem[propName] = props[propName];\n        }\n        if ($appendTo) {\n            $appendTo.appendChild($elem);\n        }\n        return $elem;\n    };\n    Coder.prototype.createDisplay = function () {\n        return this.createElement('pre', { className: this.config.displayClass }, document.body);\n    };\n    Coder.prototype.createStyle = function (type) {\n        if (type === void 0) { type = 'text/css'; }\n        return this.createElement('style', { type: type });\n    };\n    Coder.prototype.createScript = function (type) {\n        if (type === void 0) { type = 'text/javascript'; }\n        return this.createElement('script', { type: type });\n    };\n    Coder.prototype.updateDisplayScroll = function () { };\n    Coder.prototype.run = function (code) {\n        var _this = this;\n        if (code === void 0) { code = ''; }\n        var lines = code.trim().split('\\n');\n        var $style;\n        var $element;\n        var elemInnerHtml;\n        var $script;\n        return utils_1.asyncForOf(function (line) {\n            var forOfPromise;\n            var returnPromise = Promise.resolve();\n            var chars = line.split('');\n            var match = line.match(Coder.DIR_RE);\n            if (match) {\n                forOfPromise = utils_1.asyncForOf(function (char) {\n                    _this.$display.textContent += char;\n                    return returnPromise;\n                }, chars, _this.config.typingSpeed).then(function () {\n                    _this.$display.textContent += '\\n';\n                    var _a = match[1].split(':'), section = _a[0], rest = _a.slice(1);\n                    switch (section.toLowerCase()) {\n                        case 'css':\n                            // --- css\n                            // --- css:apply\n                            $script = null;\n                            $element = null;\n                            elemInnerHtml = '';\n                            $style = _this.createStyle();\n                            if (rest[0] && rest[0].toLowerCase() === 'apply') {\n                                _this.$runner.appendChild($style);\n                            }\n                            break;\n                        case 'js':\n                            $style = null;\n                            $element = null;\n                            elemInnerHtml = '';\n                            $script = _this.createScript();\n                            // can't be apply at this point, only at the end,\n                            // would throw exeptions\n                            break;\n                        case 'html':\n                            // --- html ($wrapperElem)\n                            // --- html:apply ($wrapperElem)\n                            // --- html:tag\n                            // --- html:tag.class\n                            // --- html:.class (tag = div)\n                            // --- html:tag#id\n                            // --- html:#id (tag = div)\n                            // --- html:tag:apply\n                            // --- html:apply:tag\n                            $script = null;\n                            $style = null;\n                            elemInnerHtml = '';\n                            if (rest[0]) {\n                                var elem = rest[0], apply = rest[1];\n                                // let's swap if the first one is \"apply\"\n                                if (elem.toLowerCase() === 'apply') {\n                                    _b = [apply || '', elem], elem = _b[0], apply = _b[1];\n                                }\n                                var selector = elem.match(Coder.SEL_RE);\n                                // valid selector?\n                                if (elem && selector) {\n                                    $element = document.querySelector(elem);\n                                    // does the element exist in the DOM?\n                                    if (!$element) {\n                                        var _c = [selector[1] || 'div', selector[3], selector[4]], tagName = _c[0], symbol = _c[1], name_1 = _c[2];\n                                        $element = _this.createElement(tagName);\n                                        if (symbol && name_1) {\n                                            // I know, this is crappy. Only supports classes or ids\n                                            // and not even combined. TODO: make it better\n                                            switch (symbol) {\n                                                case '.':\n                                                    $element.className = name_1;\n                                                    break;\n                                                case '#':\n                                                    $element.id = name_1;\n                                                    break;\n                                            }\n                                        }\n                                        if (apply &&\n                                            apply.toLowerCase() === 'apply' &&\n                                            !$element.parentElement) {\n                                            _this.$body.appendChild($element);\n                                        }\n                                    }\n                                }\n                                else {\n                                    $element = _this.$wrapperElem;\n                                    if (apply &&\n                                        apply.toLowerCase() === 'apply' &&\n                                        !$element.parentElement) {\n                                        _this.$body.appendChild($element);\n                                    }\n                                }\n                            }\n                            $element = $element || _this.$wrapperElem;\n                            // in case there was already content\n                            // we can continue writing html in the element\n                            elemInnerHtml = $element.innerHTML;\n                            break;\n                        case 'apply':\n                            if ($style && !$style.parentElement) {\n                                _this.$runner.appendChild($style);\n                                $style = _this.createStyle();\n                            }\n                            else if ($element && !$element.parentElement) {\n                                _this.$body.appendChild($element);\n                            }\n                            else if ($script && !$script.parentElement) {\n                                _this.$runner.appendChild($script);\n                                $script = _this.createScript();\n                            }\n                            break;\n                        case 'promise':\n                            if (window[rest[0]] instanceof Promise) {\n                                returnPromise = window[rest[0]];\n                            }\n                            break;\n                    }\n                    return returnPromise;\n                    var _b;\n                });\n            }\n            else {\n                forOfPromise = utils_1.asyncForOf(function (char) {\n                    _this.$display.textContent += char;\n                    if ($style) {\n                        $style.textContent += char;\n                    }\n                    else if ($element) {\n                        // in order to be able to write dynamic html and\n                        // see the changes right away, we need to store\n                        // the html as a string and innerHTML this string\n                        // into the the element right away. If we don't do so, \n                        // we lose markup because it becomes invalid and gets lost\n                        elemInnerHtml += char;\n                        $element.innerHTML = elemInnerHtml;\n                    }\n                    else if ($script) {\n                        $script.textContent += char;\n                    }\n                    return returnPromise;\n                }, chars, _this.config.typingSpeed).then(function () {\n                    _this.$display.textContent += '\\n';\n                    if ($style) {\n                        $style.textContent += '\\n';\n                    }\n                    else if ($script) {\n                        $script.textContent += '\\n';\n                    }\n                    return returnPromise;\n                });\n            }\n            return forOfPromise;\n        }, lines).then(function () {\n            $style = null;\n            $element = null;\n            elemInnerHtml = '';\n            $script = null;\n            return Promise.resolve();\n        });\n    };\n    Coder.DIR_RE = /^\\s*---\\s*([a-z0-9|\\-|_|\\.|#|:]+)?/i;\n    Coder.SEL_RE = /^([a-z0-9|\\-|_]+)?((\\.|#)([a-z0-9|\\-|_]+))?$/i;\n    Coder.domReady = function (callback) {\n        document.addEventListener('DOMContentLoaded', callback);\n    };\n    Coder.DEFAULT_CONFIG = {\n        displayClass: 'live-coder__display',\n        wrapperElement: 'wrapper-element',\n        typingSpeed: 50\n    };\n    return Coder;\n}());\nexports.Coder = Coder;\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./src/index.ts\n// module id = 0\n// module chunks = 0","\"use strict\";\nvar deferred_1 = require('./deferred');\nfunction asyncLoop(fn, condition, delay) {\n    var deferred = new deferred_1.Deferred();\n    var loop = function () {\n        if (condition()) {\n            fn()\n                .then(function () {\n                if (delay) {\n                    setTimeout(loop, delay);\n                }\n                else {\n                    loop();\n                }\n            })\n                .catch(function () { return deferred.reject(); });\n        }\n        else {\n            deferred.resolve();\n        }\n    };\n    loop();\n    return deferred.promise;\n}\nexports.asyncLoop = asyncLoop;\nfunction asyncForOf(fn, array, delay) {\n    var index = 0;\n    var length = array.length;\n    var value;\n    var conditionLoop = function () { return index < length; };\n    var bodyLoop = function () {\n        var value = array[index];\n        var promise = fn(value);\n        index++;\n        return promise;\n    };\n    return asyncLoop(bodyLoop, conditionLoop, delay);\n}\nexports.asyncForOf = asyncForOf;\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./src/utils.ts\n// module id = 1\n// module chunks = 0","\"use strict\";\nvar Deferred = (function () {\n    function Deferred() {\n        var _this = this;\n        this.promise = new Promise(function (resolve, reject) {\n            _this.resolve = resolve;\n            _this.reject = reject;\n        });\n    }\n    return Deferred;\n}());\nexports.Deferred = Deferred;\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./src/deferred.ts\n// module id = 2\n// module chunks = 0"],"sourceRoot":""}