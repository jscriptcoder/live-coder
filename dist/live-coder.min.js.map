{"version":3,"sources":["webpack:///dist/live-coder.min.js","webpack:///webpack/bootstrap b9512157e354877186ae","webpack:///./src/index.ts","webpack:///./src/utils.ts","webpack:///./src/deferred.ts"],"names":["Live","modules","__webpack_require__","moduleId","installedModules","exports","module","id","loaded","call","m","c","p","utils_1","CoderState","Coder","config","_this","this","Object","assign","DEFAULT_CONFIG","domReady","waitForDom","then","$runner","document","getElementsByTagName","body","$defContainer","createElement","defaultContainer","$body","$display","createDisplay","state","READY","isElementAttached","$elem","parentElement","appendIfApply","apply","$container","toLowerCase","appendChild","prototype","tagName","props","$appendTo","_i","_a","keys","length","propName","className","displayClass","createStyle","type","createScript","writeAndScrollDisplay","char","textContent","scrollTop","scrollHeight","run","code","RUNNING","$style","$element","elemInnerHtml","$script","lines","trim","split","asyncForOf","line","forOfPromise","returnPromise","Promise","resolve","chars","match","DIR_RE","typingSpeed","section","rest","slice","elem","_b","selector","SEL_RE","querySelector","_c","symbol","name_1","innerHTML","window","DONE","setTypingSpeed","pause","PAUSED","resume","asyncLoop","fn","condition","delay","deferred","deferred_1","Deferred","loop","setTimeout","catch","reject","promise","array","index","conditionLoop","bodyLoop","value","addEventListener"],"mappings":"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","file":"dist/live-coder.min.js","sourcesContent":["var Live =\n/******/ (function(modules) { // webpackBootstrap\n/******/ \t// The module cache\n/******/ \tvar installedModules = {};\n/******/\n/******/ \t// The require function\n/******/ \tfunction __webpack_require__(moduleId) {\n/******/\n/******/ \t\t// Check if module is in cache\n/******/ \t\tif(installedModules[moduleId])\n/******/ \t\t\treturn installedModules[moduleId].exports;\n/******/\n/******/ \t\t// Create a new module (and put it into the cache)\n/******/ \t\tvar module = installedModules[moduleId] = {\n/******/ \t\t\texports: {},\n/******/ \t\t\tid: moduleId,\n/******/ \t\t\tloaded: false\n/******/ \t\t};\n/******/\n/******/ \t\t// Execute the module function\n/******/ \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n/******/\n/******/ \t\t// Flag the module as loaded\n/******/ \t\tmodule.loaded = true;\n/******/\n/******/ \t\t// Return the exports of the module\n/******/ \t\treturn module.exports;\n/******/ \t}\n/******/\n/******/\n/******/ \t// expose the modules object (__webpack_modules__)\n/******/ \t__webpack_require__.m = modules;\n/******/\n/******/ \t// expose the module cache\n/******/ \t__webpack_require__.c = installedModules;\n/******/\n/******/ \t// __webpack_public_path__\n/******/ \t__webpack_require__.p = \"\";\n/******/\n/******/ \t// Load entry module and return exports\n/******/ \treturn __webpack_require__(0);\n/******/ })\n/************************************************************************/\n/******/ ([\n/* 0 */\n/***/ function(module, exports, __webpack_require__) {\n\n\t\"use strict\";\n\tvar utils_1 = __webpack_require__(1);\n\t(function (CoderState) {\n\t    CoderState[CoderState[\"READY\"] = 0] = \"READY\";\n\t    CoderState[CoderState[\"RUNNING\"] = 1] = \"RUNNING\";\n\t    CoderState[CoderState[\"PAUSED\"] = 2] = \"PAUSED\";\n\t    CoderState[CoderState[\"DONE\"] = 3] = \"DONE\";\n\t})(exports.CoderState || (exports.CoderState = {}));\n\tvar CoderState = exports.CoderState;\n\tvar Coder = (function () {\n\t    function Coder(config) {\n\t        var _this = this;\n\t        if (config === void 0) { config = {}; }\n\t        this.config = Object.assign({}, Coder.DEFAULT_CONFIG, config);\n\t        this.domReady = utils_1.waitForDom();\n\t        this.domReady.then(function () {\n\t            _this.$runner = document.getElementsByTagName('head')[0] || document.body;\n\t            _this.$defContainer = _this.createElement(_this.config.defaultContainer);\n\t            _this.$body = document.body;\n\t            _this.$display = _this.createDisplay();\n\t            _this.state = CoderState.READY;\n\t        });\n\t    }\n\t    Coder.isElementAttached = function ($elem) {\n\t        return !!$elem.parentElement;\n\t    };\n\t    Coder.appendIfApply = function (apply, $elem, $container) {\n\t        if (apply &&\n\t            $elem &&\n\t            apply.toLowerCase() === 'apply' &&\n\t            !Coder.isElementAttached($elem)) {\n\t            $container && $container.appendChild($elem);\n\t        }\n\t    };\n\t    Coder.prototype.createElement = function (tagName, props, $appendTo) {\n\t        if (props === void 0) { props = {}; }\n\t        var $elem = document.createElement(tagName);\n\t        for (var _i = 0, _a = Object.keys(props); _i < _a.length; _i++) {\n\t            var propName = _a[_i];\n\t            $elem[propName] = props[propName];\n\t        }\n\t        if ($appendTo) {\n\t            $appendTo.appendChild($elem);\n\t        }\n\t        return $elem;\n\t    };\n\t    Coder.prototype.createDisplay = function () {\n\t        return this.createElement('pre', { className: this.config.displayClass }, document.body);\n\t    };\n\t    Coder.prototype.createStyle = function (type) {\n\t        if (type === void 0) { type = 'text/css'; }\n\t        return this.createElement('style', { type: type });\n\t    };\n\t    Coder.prototype.createScript = function (type) {\n\t        if (type === void 0) { type = 'text/javascript'; }\n\t        return this.createElement('script', { type: type });\n\t    };\n\t    Coder.prototype.writeAndScrollDisplay = function (char) {\n\t        this.$display.textContent += char;\n\t        this.$display.scrollTop = this.$display.scrollHeight;\n\t    };\n\t    Coder.prototype.run = function (code) {\n\t        var _this = this;\n\t        if (code === void 0) { code = ''; }\n\t        return this.domReady.then(function () {\n\t            _this.state = CoderState.RUNNING;\n\t            var lines = code.trim().split('\\n');\n\t            var $style;\n\t            var $element;\n\t            var elemInnerHtml;\n\t            var $script;\n\t            return utils_1.asyncForOf(function (line) {\n\t                var forOfPromise;\n\t                var returnPromise = Promise.resolve();\n\t                var chars = line.split('');\n\t                var match = line.match(Coder.DIR_RE);\n\t                if (match) {\n\t                    forOfPromise = utils_1.asyncForOf(function (char) {\n\t                        _this.writeAndScrollDisplay(char);\n\t                        return returnPromise;\n\t                    }, chars, _this.config.typingSpeed).then(function () {\n\t                        _this.$display.textContent += '\\n';\n\t                        var _a = match[1].split(':'), section = _a[0], rest = _a.slice(1);\n\t                        switch (section.toLowerCase()) {\n\t                            case 'css':\n\t                                // --- css\n\t                                // --- css:apply\n\t                                $script = null;\n\t                                $element = null;\n\t                                elemInnerHtml = '';\n\t                                $style = _this.createStyle();\n\t                                Coder.appendIfApply(rest[0], $style, _this.$runner);\n\t                                break;\n\t                            case 'js':\n\t                                $style = null;\n\t                                $element = null;\n\t                                elemInnerHtml = '';\n\t                                $script = _this.createScript();\n\t                                // can't be apply at this point, only at the end,\n\t                                // would throw exeptions\n\t                                break;\n\t                            case 'html':\n\t                                // --- html ($defContainer)\n\t                                // --- html:apply ($defContainer)\n\t                                // --- html:tag\n\t                                // --- html:tag.class\n\t                                // --- html:.class (tag = div)\n\t                                // --- html:tag#id\n\t                                // --- html:#id (tag = div)\n\t                                // --- html:tag:apply\n\t                                // --- html:apply:tag\n\t                                $script = null;\n\t                                $style = null;\n\t                                elemInnerHtml = '';\n\t                                if (rest[0]) {\n\t                                    var elem = rest[0], apply = rest[1];\n\t                                    // let's swap if the first one is \"apply\"\n\t                                    if (elem.toLowerCase() === 'apply') {\n\t                                        _b = [apply || '', elem], elem = _b[0], apply = _b[1];\n\t                                    }\n\t                                    var selector = elem.match(Coder.SEL_RE);\n\t                                    // valid selector?\n\t                                    if (elem && selector) {\n\t                                        $element = document.querySelector(elem);\n\t                                        // does the element exist in the DOM?\n\t                                        if (!$element) {\n\t                                            var _c = [selector[1] || 'div', selector[3], selector[4]], tagName = _c[0], symbol = _c[1], name_1 = _c[2];\n\t                                            $element = _this.createElement(tagName);\n\t                                            if (symbol && name_1) {\n\t                                                // I know, this is crappy. Only supports classes or ids\n\t                                                // and not even combined. TODO: make it better\n\t                                                switch (symbol) {\n\t                                                    case '.':\n\t                                                        $element.className = name_1;\n\t                                                        break;\n\t                                                    case '#':\n\t                                                        $element.id = name_1;\n\t                                                        break;\n\t                                                }\n\t                                            }\n\t                                            Coder.appendIfApply(apply, $element, _this.$body);\n\t                                        }\n\t                                    }\n\t                                    else {\n\t                                        $element = _this.$defContainer;\n\t                                        Coder.appendIfApply(apply, $element, _this.$body);\n\t                                    }\n\t                                }\n\t                                $element = $element || _this.$defContainer;\n\t                                // in case there was already content\n\t                                // we can continue writing html in the element\n\t                                elemInnerHtml = $element.innerHTML;\n\t                                break;\n\t                            case 'apply':\n\t                                if ($style && !Coder.isElementAttached($style)) {\n\t                                    _this.$runner.appendChild($style);\n\t                                    $style = _this.createStyle();\n\t                                }\n\t                                else if ($element && !Coder.isElementAttached($element)) {\n\t                                    _this.$body.appendChild($element);\n\t                                }\n\t                                else if ($script && !Coder.isElementAttached($script)) {\n\t                                    _this.$runner.appendChild($script);\n\t                                    $script = _this.createScript();\n\t                                }\n\t                                break;\n\t                            case 'await': // --- await:promiseVar\n\t                            case 'promise':\n\t                                if (window[rest[0]] instanceof Promise) {\n\t                                    returnPromise = window[rest[0]];\n\t                                }\n\t                                break;\n\t                        }\n\t                        return returnPromise;\n\t                        var _b;\n\t                    });\n\t                }\n\t                else {\n\t                    forOfPromise = utils_1.asyncForOf(function (char) {\n\t                        _this.writeAndScrollDisplay(char);\n\t                        if ($style) {\n\t                            $style.textContent += char;\n\t                        }\n\t                        else if ($element) {\n\t                            // in order to be able to write dynamic html and\n\t                            // see the changes right away, we need to store\n\t                            // the html as a string and innerHTML this string\n\t                            // into the the element right away. If we don't do so, \n\t                            // we lose markup because it becomes invalid and gets lost\n\t                            elemInnerHtml += char;\n\t                            $element.innerHTML = elemInnerHtml;\n\t                        }\n\t                        else if ($script) {\n\t                            $script.textContent += char;\n\t                        }\n\t                        return returnPromise;\n\t                    }, chars, _this.config.typingSpeed).then(function () {\n\t                        _this.writeAndScrollDisplay('\\n');\n\t                        if ($style) {\n\t                            $style.textContent += '\\n';\n\t                        }\n\t                        else if ($script) {\n\t                            $script.textContent += '\\n';\n\t                        }\n\t                        return returnPromise;\n\t                    });\n\t                }\n\t                return forOfPromise;\n\t            }, lines).then(function () {\n\t                $style = null;\n\t                $element = null;\n\t                elemInnerHtml = '';\n\t                $script = null;\n\t                _this.state = CoderState.DONE;\n\t                return Promise.resolve();\n\t            });\n\t        });\n\t    };\n\t    Coder.prototype.setTypingSpeed = function (typingSpeed) {\n\t        this.config.typingSpeed = typingSpeed;\n\t    };\n\t    Coder.prototype.pause = function () {\n\t        this.state = CoderState.PAUSED;\n\t    };\n\t    Coder.prototype.resume = function () {\n\t        this.state = CoderState.RUNNING;\n\t    };\n\t    Coder.DIR_RE = /^\\s*---\\s*([a-z0-9|\\-|_|\\.|#|:]+)?/i;\n\t    Coder.SEL_RE = /^([a-z0-9|\\-|_]+)?((\\.|#)([a-z0-9|\\-|_]+))?$/i;\n\t    Coder.DEFAULT_CONFIG = {\n\t        displayClass: 'live-coder__display',\n\t        defaultContainer: 'default-container',\n\t        typingSpeed: 50\n\t    };\n\t    return Coder;\n\t}());\n\texports.Coder = Coder;\n\n\n/***/ },\n/* 1 */\n/***/ function(module, exports, __webpack_require__) {\n\n\t\"use strict\";\n\tvar deferred_1 = __webpack_require__(2);\n\tfunction asyncLoop(fn, condition, delay) {\n\t    var deferred = new deferred_1.Deferred();\n\t    var loop = function () {\n\t        if (condition()) {\n\t            fn()\n\t                .then(function () {\n\t                if (delay) {\n\t                    setTimeout(loop, delay);\n\t                }\n\t                else {\n\t                    loop();\n\t                }\n\t            })\n\t                .catch(function () { return deferred.reject(); });\n\t        }\n\t        else {\n\t            deferred.resolve();\n\t        }\n\t    };\n\t    loop();\n\t    return deferred.promise;\n\t}\n\texports.asyncLoop = asyncLoop;\n\tfunction asyncForOf(fn, array, delay) {\n\t    var index = 0;\n\t    var length = array.length;\n\t    var value;\n\t    var conditionLoop = function () { return index < length; };\n\t    var bodyLoop = function () {\n\t        var value = array[index];\n\t        var promise = fn(value);\n\t        index++;\n\t        return promise;\n\t    };\n\t    return asyncLoop(bodyLoop, conditionLoop, delay);\n\t}\n\texports.asyncForOf = asyncForOf;\n\tfunction waitForDom() {\n\t    return new Promise(function (resolve) {\n\t        document.addEventListener('DOMContentLoaded', function () { return resolve(); });\n\t    });\n\t}\n\texports.waitForDom = waitForDom;\n\n\n/***/ },\n/* 2 */\n/***/ function(module, exports) {\n\n\t\"use strict\";\n\tvar Deferred = (function () {\n\t    function Deferred() {\n\t        var _this = this;\n\t        this.promise = new Promise(function (resolve, reject) {\n\t            _this.resolve = resolve;\n\t            _this.reject = reject;\n\t        });\n\t    }\n\t    return Deferred;\n\t}());\n\texports.Deferred = Deferred;\n\n\n/***/ }\n/******/ ]);\n\n\n// WEBPACK FOOTER //\n// dist/live-coder.min.js"," \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId])\n \t\t\treturn installedModules[moduleId].exports;\n\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\texports: {},\n \t\t\tid: moduleId,\n \t\t\tloaded: false\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.loaded = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"\";\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(0);\n\n\n\n// WEBPACK FOOTER //\n// webpack/bootstrap b9512157e354877186ae","\"use strict\";\nvar utils_1 = require('./utils');\n(function (CoderState) {\n    CoderState[CoderState[\"READY\"] = 0] = \"READY\";\n    CoderState[CoderState[\"RUNNING\"] = 1] = \"RUNNING\";\n    CoderState[CoderState[\"PAUSED\"] = 2] = \"PAUSED\";\n    CoderState[CoderState[\"DONE\"] = 3] = \"DONE\";\n})(exports.CoderState || (exports.CoderState = {}));\nvar CoderState = exports.CoderState;\nvar Coder = (function () {\n    function Coder(config) {\n        var _this = this;\n        if (config === void 0) { config = {}; }\n        this.config = Object.assign({}, Coder.DEFAULT_CONFIG, config);\n        this.domReady = utils_1.waitForDom();\n        this.domReady.then(function () {\n            _this.$runner = document.getElementsByTagName('head')[0] || document.body;\n            _this.$defContainer = _this.createElement(_this.config.defaultContainer);\n            _this.$body = document.body;\n            _this.$display = _this.createDisplay();\n            _this.state = CoderState.READY;\n        });\n    }\n    Coder.isElementAttached = function ($elem) {\n        return !!$elem.parentElement;\n    };\n    Coder.appendIfApply = function (apply, $elem, $container) {\n        if (apply &&\n            $elem &&\n            apply.toLowerCase() === 'apply' &&\n            !Coder.isElementAttached($elem)) {\n            $container && $container.appendChild($elem);\n        }\n    };\n    Coder.prototype.createElement = function (tagName, props, $appendTo) {\n        if (props === void 0) { props = {}; }\n        var $elem = document.createElement(tagName);\n        for (var _i = 0, _a = Object.keys(props); _i < _a.length; _i++) {\n            var propName = _a[_i];\n            $elem[propName] = props[propName];\n        }\n        if ($appendTo) {\n            $appendTo.appendChild($elem);\n        }\n        return $elem;\n    };\n    Coder.prototype.createDisplay = function () {\n        return this.createElement('pre', { className: this.config.displayClass }, document.body);\n    };\n    Coder.prototype.createStyle = function (type) {\n        if (type === void 0) { type = 'text/css'; }\n        return this.createElement('style', { type: type });\n    };\n    Coder.prototype.createScript = function (type) {\n        if (type === void 0) { type = 'text/javascript'; }\n        return this.createElement('script', { type: type });\n    };\n    Coder.prototype.writeAndScrollDisplay = function (char) {\n        this.$display.textContent += char;\n        this.$display.scrollTop = this.$display.scrollHeight;\n    };\n    Coder.prototype.run = function (code) {\n        var _this = this;\n        if (code === void 0) { code = ''; }\n        return this.domReady.then(function () {\n            _this.state = CoderState.RUNNING;\n            var lines = code.trim().split('\\n');\n            var $style;\n            var $element;\n            var elemInnerHtml;\n            var $script;\n            return utils_1.asyncForOf(function (line) {\n                var forOfPromise;\n                var returnPromise = Promise.resolve();\n                var chars = line.split('');\n                var match = line.match(Coder.DIR_RE);\n                if (match) {\n                    forOfPromise = utils_1.asyncForOf(function (char) {\n                        _this.writeAndScrollDisplay(char);\n                        return returnPromise;\n                    }, chars, _this.config.typingSpeed).then(function () {\n                        _this.$display.textContent += '\\n';\n                        var _a = match[1].split(':'), section = _a[0], rest = _a.slice(1);\n                        switch (section.toLowerCase()) {\n                            case 'css':\n                                // --- css\n                                // --- css:apply\n                                $script = null;\n                                $element = null;\n                                elemInnerHtml = '';\n                                $style = _this.createStyle();\n                                Coder.appendIfApply(rest[0], $style, _this.$runner);\n                                break;\n                            case 'js':\n                                $style = null;\n                                $element = null;\n                                elemInnerHtml = '';\n                                $script = _this.createScript();\n                                // can't be apply at this point, only at the end,\n                                // would throw exeptions\n                                break;\n                            case 'html':\n                                // --- html ($defContainer)\n                                // --- html:apply ($defContainer)\n                                // --- html:tag\n                                // --- html:tag.class\n                                // --- html:.class (tag = div)\n                                // --- html:tag#id\n                                // --- html:#id (tag = div)\n                                // --- html:tag:apply\n                                // --- html:apply:tag\n                                $script = null;\n                                $style = null;\n                                elemInnerHtml = '';\n                                if (rest[0]) {\n                                    var elem = rest[0], apply = rest[1];\n                                    // let's swap if the first one is \"apply\"\n                                    if (elem.toLowerCase() === 'apply') {\n                                        _b = [apply || '', elem], elem = _b[0], apply = _b[1];\n                                    }\n                                    var selector = elem.match(Coder.SEL_RE);\n                                    // valid selector?\n                                    if (elem && selector) {\n                                        $element = document.querySelector(elem);\n                                        // does the element exist in the DOM?\n                                        if (!$element) {\n                                            var _c = [selector[1] || 'div', selector[3], selector[4]], tagName = _c[0], symbol = _c[1], name_1 = _c[2];\n                                            $element = _this.createElement(tagName);\n                                            if (symbol && name_1) {\n                                                // I know, this is crappy. Only supports classes or ids\n                                                // and not even combined. TODO: make it better\n                                                switch (symbol) {\n                                                    case '.':\n                                                        $element.className = name_1;\n                                                        break;\n                                                    case '#':\n                                                        $element.id = name_1;\n                                                        break;\n                                                }\n                                            }\n                                            Coder.appendIfApply(apply, $element, _this.$body);\n                                        }\n                                    }\n                                    else {\n                                        $element = _this.$defContainer;\n                                        Coder.appendIfApply(apply, $element, _this.$body);\n                                    }\n                                }\n                                $element = $element || _this.$defContainer;\n                                // in case there was already content\n                                // we can continue writing html in the element\n                                elemInnerHtml = $element.innerHTML;\n                                break;\n                            case 'apply':\n                                if ($style && !Coder.isElementAttached($style)) {\n                                    _this.$runner.appendChild($style);\n                                    $style = _this.createStyle();\n                                }\n                                else if ($element && !Coder.isElementAttached($element)) {\n                                    _this.$body.appendChild($element);\n                                }\n                                else if ($script && !Coder.isElementAttached($script)) {\n                                    _this.$runner.appendChild($script);\n                                    $script = _this.createScript();\n                                }\n                                break;\n                            case 'await': // --- await:promiseVar\n                            case 'promise':\n                                if (window[rest[0]] instanceof Promise) {\n                                    returnPromise = window[rest[0]];\n                                }\n                                break;\n                        }\n                        return returnPromise;\n                        var _b;\n                    });\n                }\n                else {\n                    forOfPromise = utils_1.asyncForOf(function (char) {\n                        _this.writeAndScrollDisplay(char);\n                        if ($style) {\n                            $style.textContent += char;\n                        }\n                        else if ($element) {\n                            // in order to be able to write dynamic html and\n                            // see the changes right away, we need to store\n                            // the html as a string and innerHTML this string\n                            // into the the element right away. If we don't do so, \n                            // we lose markup because it becomes invalid and gets lost\n                            elemInnerHtml += char;\n                            $element.innerHTML = elemInnerHtml;\n                        }\n                        else if ($script) {\n                            $script.textContent += char;\n                        }\n                        return returnPromise;\n                    }, chars, _this.config.typingSpeed).then(function () {\n                        _this.writeAndScrollDisplay('\\n');\n                        if ($style) {\n                            $style.textContent += '\\n';\n                        }\n                        else if ($script) {\n                            $script.textContent += '\\n';\n                        }\n                        return returnPromise;\n                    });\n                }\n                return forOfPromise;\n            }, lines).then(function () {\n                $style = null;\n                $element = null;\n                elemInnerHtml = '';\n                $script = null;\n                _this.state = CoderState.DONE;\n                return Promise.resolve();\n            });\n        });\n    };\n    Coder.prototype.setTypingSpeed = function (typingSpeed) {\n        this.config.typingSpeed = typingSpeed;\n    };\n    Coder.prototype.pause = function () {\n        this.state = CoderState.PAUSED;\n    };\n    Coder.prototype.resume = function () {\n        this.state = CoderState.RUNNING;\n    };\n    Coder.DIR_RE = /^\\s*---\\s*([a-z0-9|\\-|_|\\.|#|:]+)?/i;\n    Coder.SEL_RE = /^([a-z0-9|\\-|_]+)?((\\.|#)([a-z0-9|\\-|_]+))?$/i;\n    Coder.DEFAULT_CONFIG = {\n        displayClass: 'live-coder__display',\n        defaultContainer: 'default-container',\n        typingSpeed: 50\n    };\n    return Coder;\n}());\nexports.Coder = Coder;\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./src/index.ts\n// module id = 0\n// module chunks = 0","\"use strict\";\nvar deferred_1 = require('./deferred');\nfunction asyncLoop(fn, condition, delay) {\n    var deferred = new deferred_1.Deferred();\n    var loop = function () {\n        if (condition()) {\n            fn()\n                .then(function () {\n                if (delay) {\n                    setTimeout(loop, delay);\n                }\n                else {\n                    loop();\n                }\n            })\n                .catch(function () { return deferred.reject(); });\n        }\n        else {\n            deferred.resolve();\n        }\n    };\n    loop();\n    return deferred.promise;\n}\nexports.asyncLoop = asyncLoop;\nfunction asyncForOf(fn, array, delay) {\n    var index = 0;\n    var length = array.length;\n    var value;\n    var conditionLoop = function () { return index < length; };\n    var bodyLoop = function () {\n        var value = array[index];\n        var promise = fn(value);\n        index++;\n        return promise;\n    };\n    return asyncLoop(bodyLoop, conditionLoop, delay);\n}\nexports.asyncForOf = asyncForOf;\nfunction waitForDom() {\n    return new Promise(function (resolve) {\n        document.addEventListener('DOMContentLoaded', function () { return resolve(); });\n    });\n}\nexports.waitForDom = waitForDom;\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./src/utils.ts\n// module id = 1\n// module chunks = 0","\"use strict\";\nvar Deferred = (function () {\n    function Deferred() {\n        var _this = this;\n        this.promise = new Promise(function (resolve, reject) {\n            _this.resolve = resolve;\n            _this.reject = reject;\n        });\n    }\n    return Deferred;\n}());\nexports.Deferred = Deferred;\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./src/deferred.ts\n// module id = 2\n// module chunks = 0"],"sourceRoot":""}